<!DOCTYPE html>
<html lang="en" data-lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free Grade Calculator - What Grade Do I Need on My Final? | GPA & Final Exam Calculator</title>
    <meta name="description" content="Free grade calculator & predictor - Calculate what you need on finals, tests & assignments to reach your target grade. Instant GPA calculation with weighted grades, letter grades (A-F), percentages. Perfect for college & high school students.">
    <meta name="keywords" content="grade calculator, final grade calculator, what grade do I need, grade prediction, GPA calculator, weighted grade calculator, final exam calculator, college grade calculator, high school grade calculator, grade predictor, target grade calculator, semester grade calculator, class grade calculator, assignment grade calculator, test grade calculator, course grade calculator, grade percentage calculator, letter grade calculator, calculate my grade, grade average calculator, academic grade calculator, student grade calculator, free grade calculator, online grade calculator, grade calculation tool">
    <meta name="author" content="Grade Prediction Calculator">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <link rel="canonical" href="https://neverhard.com">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://neverhard.com">
    <meta property="og:title" content="Free Grade Calculator - What Grade Do I Need? | Final Exam & GPA Calculator">
    <meta property="og:description" content="Calculate what grade you need on your final exam or assignments to reach your target. Free weighted grade calculator with instant results. Perfect for students planning their semester grades.">
    <meta property="og:image" content="https://neverhard.com/static/main/images/og-image.jpg">
    <meta property="og:locale" content="en_US">
    <meta property="og:site_name" content="Grade Prediction Calculator">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://neverhard.com">
    <meta name="twitter:title" content="Free Grade Calculator - What Grade Do I Need on My Final?">
    <meta name="twitter:description" content="Calculate what grade you need on finals, tests & assignments to reach your target. Free weighted GPA calculator for students.">
    <meta name="twitter:image" content="https://neverhard.com/static/main/images/twitter-image.jpg">
    
    <!-- Additional SEO -->
    <meta name="theme-color" content="#FF8000">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Grade Calculator">
    <meta name="application-name" content="Grade Calculator">
    <meta name="msapplication-TileColor" content="#FF8000">
    <meta name="format-detection" content="telephone=no">
    
    {% load static %}
    <link rel="icon" type="image/png" href="{% static 'main/images/favicon-96x96.png' %}" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="{% static 'main/images/favicon.svg' %}" />
    <link rel="shortcut icon" href="{% static 'main/images/favicon.ico' %}" />
    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'main/images/apple-touch-icon.png' %}" />
    <link rel="manifest" href="{% static 'main/images/site.webmanifest' %}" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7380460452331152"
     crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=JetBrains+Mono:wght@400;700&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet">
    <script type="application/ld+json">

    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Grade Calculator - Final Exam & GPA Calculator",
        "alternateName": ["Final Grade Calculator", "What Grade Do I Need Calculator", "GPA Calculator", "Weighted Grade Calculator"],
        "description": "Free online grade calculator to predict what grades you need on finals, tests, and assignments to reach your target grade. Supports weighted grades, letter grades (A-F), percentages, and GPA calculation for college and high school students.",
        "url": "https://neverhard.com",
        "applicationCategory": "EducationalApplication",
        "operatingSystem": "Any",
        "browserRequirements": "Requires JavaScript. Modern web browser recommended.",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "featureList": [
            "Final exam grade calculation",
            "Weighted grade calculator",
            "Letter grade conversion (A-F)",
            "Percentage-based calculations",
            "Multiple assignment types support",
            "Test grade tracking",
            "GPA prediction",
            "Target grade planning",
            "Real-time calculation",
            "Mobile-friendly interface"
        ],
        "inLanguage": ["en", "kk", "ru"],
        "author": {
            "@type": "Organization",
            "name": "NeverHard",
            "url": "https://neverhard.com",
            "logo": "https://neverhard.com/static/main/images/logo.png",
        }
    }
    </script>
    
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
                "@type": "Question",
                "name": "How do I calculate what grade I need on my final exam?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Enter your current grades for assignments and tests, specify the weight of your final exam (typically 30-50% of total grade), and our calculator will show you exactly what score you need on the final to reach your target grade. The calculator supports weighted grades and handles multiple grading scales including letter grades and percentages."
                }
            },
            {
                "@type": "Question",
                "name": "Can this calculator work with letter grades (A, B, C, D, F)?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Yes! Our grade calculator automatically converts between letter grades (A-F) and numeric grades. In English mode, results are displayed as letter grades with percentage equivalents. The calculator handles standard grading scales: A (85-100%), B (65-84%), C (40-64%), F (0-39%)."
                }
            },
            {
                "@type": "Question",
                "name": "How does weighted grade calculation work?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Weighted grades give different importance to various components of your course. For example, assignments might be 25% of your final grade, tests 25%, and the final exam 50%. Our calculator lets you customize these weights to match your syllabus, ensuring accurate predictions for what you need to achieve your target grade."
                }
            },
            {
                "@type": "Question",
                "name": "Is this grade calculator free to use?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Yes, this grade calculator is completely free with no registration required. Calculate unlimited grade predictions for finals, tests, assignments, and overall course grades. Perfect for college students, high school students, and anyone tracking their academic performance."
                }
            },
            {
                "@type": "Question",
                "name": "Can I calculate my GPA with this tool?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Yes! This calculator helps you predict your final course grade, which directly impacts your GPA. Enter your current assignment and test grades, set your target grade, and see what you need on remaining work to achieve that GPA-boosting grade in your course."
                }
            }
        ]
    }
    </script>
    
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "HowTo",
        "name": "How to Calculate What Grade You Need on Your Final Exam",
        "description": "Step-by-step guide to calculating what grade you need on your final exam to reach your target course grade",
        "step": [
            {
                "@type": "HowToStep",
                "position": 1,
                "name": "Enter Your Assignment Grades",
                "text": "Add all your completed assignment grades. You can organize them by type (homework, projects, etc.) and specify the maximum possible score for each."
            },
            {
                "@type": "HowToStep",
                "position": 2,
                "name": "Add Your Test Scores",
                "text": "Input all completed test scores with their maximum values. Specify how many total tests are expected in the course."
            },
            {
                "@type": "HowToStep",
                "position": 3,
                "name": "Set Grade Weights",
                "text": "Adjust the percentage weight for assignments, tests, and final exam to match your course syllabus (must total 100%)."
            },
            {
                "@type": "HowToStep",
                "position": 4,
                "name": "Calculate Your Results",
                "text": "Click 'Calculate Prediction' to see your current grade and what scores you need on your final exam to reach each target grade (A, B, C)."
            }
        ],
        "totalTime": "PT2M"
    }
    </script>
    
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            {
                "@type": "ListItem",
                "position": 1,
                "name": "Home",
                "item": "https://neverhard.com"
            },
            {
                "@type": "ListItem",
                "position": 2,
                "name": "Grade Calculator",
                "item": "https://neverhard.com"
            }
        ]
    }
    </script>

    <style>
        /* --- CSS VARIABLES (The DNA of your Brand) --- */
        :root {
            /* Color Palette - The "McLaren" Tech Vibe */
            --color-bg-deep: #0A192F;      /* Deep Void Blue (Main Background) */
            --color-bg-surface: #112240;   /* Lighter Blue (Cards/Sections) */
            --color-accent: #FF8000;       /* Apex Orange (Primary Action) */
            --color-accent-hover: #CC6600; /* Darker Orange for interactions */
            
            /* Text Colors */
            --color-text-main: #CCD6F6;    /* Off-white for readability */
            --color-text-heading: #FFFFFF; /* Pure white for confident headers */
            --color-text-muted: #8892B0;   /* Grey-blue for secondary info */
            
            /* Typography */
            --font-display: 'Space Grotesk', sans-serif; /* Headlines - Modern & Geometric */
            --font-body: 'Inter', sans-serif;            /* Body - Clean & Readable */
            --font-code: 'JetBrains Mono', monospace;    /* Data/Code - Tech Savvy */
            
            /* Spacing & Rounding */
            --radius-sm: 4px;
            --radius-md: 8px;   /* "Welcoming" rounded corners */
            --radius-lg: 16px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: var(--color-bg-deep);
            color: var(--color-text-main);
            font-family: var(--font-body);
            line-height: 1.6;
            min-height: 100vh;
            padding: 40px 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: var(--color-bg-surface);
            border-radius: var(--radius-lg);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            animation: fadeInUp 0.6s ease-out;
            border: 1px solid #233554;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .header {
            padding: 48px 40px 40px;
            background: linear-gradient(135deg, #0A192F 0%, #112240 100%);
            position: relative;
            overflow: hidden;
            color: var(--color-text-heading);
            text-align: center;
            border-bottom: 1px solid #233554;
        }

        .language-switcher {
            position: absolute;
            top: 16px;
            right: 16px;
            display: flex;
            gap: 8px;
            z-index: 10;
        }

        .lang-btn {
            padding: 6px 12px;
            background: rgba(255, 128, 0, 0.1);
            border: 1px solid var(--color-accent);
            color: var(--color-accent);
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-transform: uppercase;
            font-family: var(--font-code);
        }

        .lang-btn:hover {
            background: rgba(255, 128, 0, 0.2);
            border-color: var(--color-accent-hover);
        }

        .lang-btn.active {
            background: var(--color-accent);
            color: var(--color-bg-deep);
            border-color: var(--color-accent);
        }

        .header h1 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 12px;
            position: relative;
            z-index: 1;
            font-family: var(--font-display);
        }

        .header p {
            font-size: 16px;
            opacity: 0.9;
            max-width: 500px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
            color: var(--color-text-muted);
        }

        .content {
            padding: 40px;
        }

        @media (max-width: 600px) {
            .content {
                padding: 20px;
            }
            .header {
                padding: 30px 20px 20px;
            }
            .header h1 {
                font-size: 22px;
            }
            .header p {
                font-size: 14px;
            }
        }

        .section {
            margin-bottom: 36px;
            padding-bottom: 36px;
            border-bottom: 1px solid #233554;
            animation: fadeIn 0.5s ease-out backwards;
        }

        .section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 17px;
            font-weight: 600;
            color: var(--color-accent);
            font-family: var(--font-code);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .section-info {
            font-size: 13px;
            color: var(--color-text-muted);
            margin-left: 8px;
        }

        .add-btn {
            background: var(--color-accent);
            color: var(--color-bg-deep);
            border: none;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(255, 128, 0, 0.3);
            transition: all 0.3s ease;
            font-weight: 700;
            margin: 4px;
            margin-left: 8px;
        }

        .add-btn:hover {
            transform: scale(1.1);
            background: var(--color-accent-hover);
        }

        .grades-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
            gap: 8px;
            margin-top: 15px;
        }

        .grade-item {
            background: #0d1f3a;
            border-radius: var(--radius-md);
            padding: 8px 6px;
            text-align: center;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
            border: 1px solid #233554;
            color: var(--color-text-heading);
        }

        .grade-item.green {
            background: rgba(76, 175, 80, 0.1);
            border-color: #4CAF50;
        }

        .grade-item.orange {
            background: rgba(255, 128, 0, 0.1);
            border-color: var(--color-accent);
        }

        .grade-item.red {
            background: rgba(244, 67, 54, 0.1);
            border-color: #f44336;
        }

        .grade-item input {
            width: 100%;
            border: none;
            background: transparent;
            text-align: center;
            font-size: 15px;
            font-weight: 500;
            outline: none;
            color: var(--color-text-heading);
        }

        .remove-btn {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--color-accent);
            color: var(--color-bg-deep);
            border: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            transform: scale(0.8);
            transition: all 0.2s ease;
            font-weight: 700;
        }

        .remove-btn:hover {
            background: var(--color-accent-hover);
            transform: scale(1.1);
        }

        .grade-item .remove-btn {
            position: absolute;
            top: 4px;
            right: 4px;
            opacity: 0;
            transform: scale(0.8);
            width: 20px;
            height: 20px;
            font-size: 12px;
        }

        .grade-item:hover .remove-btn {
            opacity: 1;
            transform: scale(1);
        }

        .test-item, .final-item {
            background: #0d1f3a;
            border-radius: var(--radius-md);
            padding: 16px;
            margin-top: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.3s ease;
            border: 1px solid #233554;
            position: relative;
        }

        .test-item .remove-btn {
            position: absolute;
            top: -8px;
            right: -8px;
            opacity: 1;
            transform: scale(1);
            width: 24px;
            height: 24px;
            font-size: 14px;
        }

        .test-item .remove-btn:hover {
            background: var(--color-accent-hover);
            transform: scale(1.1);
        }

        .assignment-subsection .remove-btn {
            position: absolute;
            top: -8px;
            right: -8px;
            opacity: 1;
            transform: scale(1);
            width: 24px;
            height: 24px;
            font-size: 14px;
        }

        .assignment-subsection .remove-btn:hover {
            background: var(--color-accent-hover);
            transform: scale(1.1);
        }

        .test-item input, .final-item input {
            flex: 1;
            min-width: 80px;
            padding: 10px 14px;
            border: 1px solid #233554;
            border-radius: var(--radius-md);
            font-size: 15px;
            text-align: center;
            background: #0A192F;
            outline: none;
            transition: all 0.3s ease;
            color: var(--color-text-heading);
            font-family: var(--font-body);
        }

        .test-item input:focus, .final-item input:focus {
            border-color: var(--color-accent);
            box-shadow: 0 0 0 2px rgba(255, 128, 0, 0.2);
        }

        .slash {
            font-size: 18px;
            color: var(--color-text-muted);
            font-weight: 500;
        }

        .total-tests {
            margin-top: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .total-tests label {
            font-size: 14px;
            color: var(--color-text-muted);
        }

        .total-tests input {
            padding: 8px 12px;
            border: 1px solid #233554;
            border-radius: var(--radius-md);
            font-size: 14px;
            width: 80px;
            text-align: center;
            background: #0A192F;
            color: var(--color-text-heading);
        }

        .weight-input-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
            padding: 12px;
            background: #0d1f3a;
            border-radius: 8px;
            border: 1px solid #233554;
        }

        .weight-input-container label {
            font-size: 13px;
            color: var(--color-text-muted);
            font-weight: 500;
            white-space: nowrap;
        }

        .weight-input-container input {
            padding: 8px 12px;
            border: 1px solid #233554;
            border-radius: var(--radius-md);
            font-size: 14px;
            text-align: center;
            background: #0A192F;
            color: var(--color-text-heading);
            outline: none;
            transition: all 0.3s ease;
            width: 80px;
        }

        .weight-input-container input:focus {
            border-color: var(--color-accent);
            box-shadow: 0 0 0 2px rgba(255, 128, 0, 0.2);
        }

        .percent-label {
            font-size: 13px;
            color: var(--color-text-muted);
            font-weight: 500;
        }

        .weight-total {
            font-size: 12px;
            color: var(--color-text-muted);
            margin-left: auto;
        }

        .weight-total.warning {
            color: #ff9800;
            font-weight: 600;
        }

        .weight-total.valid {
            color: #4CAF50;
        }

        .assignment-subsection {
            background: #0d1f3a;
            border-radius: 8px;
            padding: 20px;
            margin-top: 15px;
            border: 1px solid #233554;
            position: relative;
            padding-top: 40px;
        }

        .assignment-subsection-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 12px;
        }

        .assignment-subsection-title {
            flex: 1;
            min-width: 150px;
        }

        .assignment-subsection-title input[type="text"] {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #233554;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            background: #0A192F;
            color: var(--color-text-heading);
            outline: none;
            transition: all 0.3s ease;
        }

        .assignment-subsection-title input[type="text"]:focus {
            border-color: var(--color-accent);
            box-shadow: 0 0 0 2px rgba(255, 128, 0, 0.2);
        }

        .assignment-subsection-controls {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
            position: relative;
        }

        .assignment-subsection-weight,
        .assignment-subsection-max {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .assignment-subsection-weight label,
        .assignment-subsection-max label {
            font-size: 13px;
            color: var(--color-text-muted);
            white-space: nowrap;
            font-weight: 500;
        }

        .assignment-subsection-weight input,
        .assignment-subsection-max input {
            width: 70px;
            padding: 8px 10px;
            border: 1px solid #233554;
            border-radius: 6px;
            font-size: 13px;
            text-align: center;
            background: #0A192F;
            color: var(--color-text-heading);
            transition: all 0.3s ease;
        }

        .assignment-subsection-weight input:focus,
        .assignment-subsection-max input:focus {
            border-color: var(--color-accent);
            box-shadow: 0 0 0 2px rgba(255, 128, 0, 0.2);
        }

        .add-subsection-btn {
            background: var(--color-accent);
            color: var(--color-bg-deep);
            border: none;
            padding: 10px 16px;
            border-radius: var(--radius-md);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-top: 15px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(255, 128, 0, 0.3);
        }

        .add-subsection-btn:hover {
            transform: translateY(-2px);
            background: var(--color-accent-hover);
            box-shadow: 0 6px 16px rgba(255, 128, 0, 0.4);
        }

        .add-subsection-btn span:first-child {
            font-size: 16px;
            font-weight: 700;
        }

        .assignment-subsection-grades {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
            gap: 8px;
            margin-top: 15px;
        }

        .calculate-btn {
            background: var(--color-accent);
            color: var(--color-bg-deep);
            border: none;
            padding: 14px 28px;
            border-radius: var(--radius-md);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: block;
            width: 100%;
            margin: 30px 0;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 128, 0, 0.3);
            font-family: var(--font-code);
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 128, 0, 0.4);
            background: var(--color-accent-hover);
        }

        .result {
            background: #0d1f3a;
            border-radius: var(--radius-md);
            padding: 20px;
            margin-top: 20px;
            text-align: center;
            display: none;
            animation: fadeIn 0.5s ease-out;
            border: 1px solid #233554;
        }

        .result-message {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--color-accent);
            font-family: var(--font-display);
        }

        .result-details {
            font-size: 14px;
            color: var(--color-text-muted);
            line-height: 1.6;
        }

        .ad-container {
            margin: 25px 0;
            text-align: center;
            background: #0d1f3a;
            padding: 15px;
            border-radius: var(--radius-md);
            border: 1px dashed #233554;
            color: var(--color-text-muted);
        }

        @media (max-width: 480px) {
            .test-item, .final-item {
                flex-direction: column;
                align-items: stretch;
                gap: 8px;
            }
            
            .test-item input, .final-item input {
                width: 100%;
            }
            
            .slash {
                display: none;
            }
            
            .grades-grid {
                grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
                gap: 8px;
            }
            
            .grade-item {
                padding: 10px 6px;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { 
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Loading spinner */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 128, 0, 0.3);
            border-radius: 50%;
            border-top-color: var(--color-bg-deep);
            animation: spin 1s ease-in-out infinite;
            margin-right: 8px;
            vertical-align: middle;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="language-switcher">
                <button type="button" class="lang-btn active" onclick="setLanguage('en')">EN</button>
                <button type="button" class="lang-btn" onclick="setLanguage('kk')">KK</button>
                <button type="button" class="lang-btn" onclick="setLanguage('ru')">RU</button>
            </div>
            <h1 data-en="Free Grade Calculator - What Grade Do I Need?" data-kk="Баға болжамы" data-ru="Прогноз оценок">Free Grade Calculator - What Grade Do I Need?</h1>
            <p data-en="Calculate what you need on finals, tests & assignments to reach your target grade. Instant weighted GPA calculator for students." data-kk="Мақсатыңызға жету үшін қандай баға қажет екенін есептеңіз" data-ru="Рассчитайте, какие оценки вам нужны для достижения вашей цели">Calculate what you need on finals, tests & assignments to reach your target grade. Instant weighted GPA calculator for students.</p>
        </div>

        <div class="content">
            <form id="gradeForm">
                {% csrf_token %}
                
                <!-- Top Ad Container -->
                <div class="ad-container">
                    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7380460452331152"
                        crossorigin="anonymous"></script>
                    <ins class="adsbygoogle"
                        style="display:block"
                        data-ad-format="fluid"
                        data-ad-layout-key="-gw-3+1f-3d+2z"
                        data-ad-client="ca-pub-7380460452331152"
                        data-ad-slot="3760481643"></ins>
                    <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
                </div>

                <!-- Assignments Section -->
                <div class="section">
                    <div class="section-header">
                        <div>
                            <span class="section-title" data-en="Assignments" data-kk="Тапсырмалар" data-ru="Задания">Assignments</span>
                            <span class="section-info" data-en="out of 10" data-kk="10-дан" data-ru="из 10">out of 10</span>
                        </div>
                    </div>
                    <div class="weight-input-container">
                        <label data-en="Weight:" data-kk="Салмақ:" data-ru="Вес:">Weight:</label>
                        <input type="number" id="weightAssignments" min="0" max="100" step="0.1" value="25" placeholder="25" readonly>
                        <span class="percent-label">%</span>
                        <span class="weight-total" id="assignmentsWeightStatus">(auto-calculated)</span>
                    </div>
                    <div id="assignmentSubsections">
                        <!-- Subsections will be added here -->
                    </div>
                    <button type="button" class="add-subsection-btn" onclick="addAssignmentSubsection()" data-en="+ Add Assignment Type" data-kk="+ Тапсырма түрін қосу" data-ru="+ Добавить тип задания">
                        <span>+</span>
                        <span data-en="Add Assignment Type" data-kk="Тапсырма түрін қосу" data-ru="Добавить тип задания">Add Assignment Type</span>
                    </button>
                </div>

                <!-- Tests Section -->
                <div class="section">
                    <div class="section-header">
                        <div>
                            <span class="section-title" data-en="Tests" data-kk="Тестілер" data-ru="Тесты">Tests</span>
                            <span class="section-info" id="testCount" data-en="0 completed" data-kk="0 аяқталды" data-ru="0 завершено">0 completed</span>
                        </div>
                        <button type="button" class="add-btn" onclick="addTest()">+</button>
                    </div>
                    <div class="weight-input-container">
                        <label data-en="Weight:" data-kk="Салмақ:" data-ru="Вес:">Weight:</label>
                        <input type="number" id="weightTests" min="0" max="100" step="0.1" value="25" placeholder="25">
                        <span class="percent-label">%</span>
                        <span class="weight-total" id="testsWeightStatus"></span>
                    </div>
                    <div id="testsContainer">
                        <!-- Default test will be added by JavaScript -->
                    </div>
                    <div class="total-tests">
                        <label data-en="Total number of tests expected:" data-kk="Күтілетін тестілердің жалпы саны:" data-ru="Ожидаемое общее количество тестов:">Total number of tests expected:</label>
                        <input type="number" id="totalTests" min="0" placeholder="e.g., 4">
                    </div>
                </div>

                <!-- Final Section -->
                <div class="section">
                    <div class="section-header">
                        <div class="section-title" data-en="Final Exam" data-kk="Қорытынды емтихан" data-ru="Финальный экзамен">Final Exam</div>
                    </div>
                    <div class="weight-input-container">
                        <label data-en="Weight:" data-kk="Салмақ:" data-ru="Вес:">Weight:</label>
                        <input type="number" id="weightFinal" min="0" max="100" step="0.1" value="50" placeholder="50">
                        <span class="percent-label">%</span>
                        <span class="weight-total" id="finalWeightStatus"></span>
                    </div>
                    <div class="final-item">
                        <input type="number" id="finalGrade" placeholder="Your grade" step="0.01" data-placeholder-en="Your grade" data-placeholder-kk="Сіздің баға" data-placeholder-ru="Ваша оценка">
                        <span class="slash">/</span>
                        <input type="number" id="finalMax" placeholder="Max grade" step="0.01" value="10" data-placeholder-en="Max grade" data-placeholder-kk="Максималды баға" data-placeholder-ru="Максимальная оценка">
                    </div>
                </div>

                <button type="submit" class="calculate-btn" data-en="Calculate Prediction" data-kk="Бағаны есептеу" data-ru="Рассчитать прогноз">
                    <span class="btn-text">Calculate Prediction</span>
                    <span class="spinner" style="display: none;"></span>
                </button>

                <!-- Middle Ad Container -->
                <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7380460452331152"
                    crossorigin="anonymous"></script>
                <ins class="adsbygoogle"
                    style="display:block"
                    data-ad-format="fluid"
                    data-ad-layout-key="-fb+5w+4e-db+86"
                    data-ad-client="ca-pub-7380460452331152"
                    data-ad-slot="8462143986"></ins>
                <script>
                    (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            </form>

            <div class="result" id="result">
                <div class="result-message" id="resultMessage"></div>
                <div class="result-details" id="resultDetails"></div>
            </div>

            <!-- Bottom Ad Container -->
            <div class="ad-container">
                <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7380460452331152"
                    crossorigin="anonymous"></script>
                <ins class="adsbygoogle"
                    style="display:block"
                    data-ad-format="autorelaxed"
                    data-ad-client="ca-pub-7380460452331152"
                    data-ad-slot="2116033966"></ins>
                <script>
                    (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            </div>
            
            <!-- SEO Content Section -->
            <article style="margin-top: 40px; padding-top: 30px; border-top: 1px solid #233554;">
                <section style="margin-bottom: 30px;">
                    <h2 style="font-size: 20px; color: var(--color-accent); margin-bottom: 15px; font-family: var(--font-display);">
                        How to Use This Grade Calculator
                    </h2>
                    <p style="color: var(--color-text-main); line-height: 1.8; margin-bottom: 12px;">
                        This free <strong>final grade calculator</strong> helps students answer the critical question: "What grade do I need on my final exam?" Whether you're a college student planning your semester or a high school student tracking your course grades, our <strong>weighted grade calculator</strong> provides instant, accurate predictions.
                    </p>
                    <p style="color: var(--color-text-main); line-height: 1.8; margin-bottom: 12px;">
                        Simply enter your current <strong>assignment grades</strong>, <strong>test scores</strong>, and the weight distribution from your syllabus. The calculator automatically computes your current standing and shows exactly what you need on remaining work to achieve your target grade (A, B, C, or any custom goal).
                    </p>
                </section>
                
                <section style="margin-bottom: 30px;">
                    <h2 style="font-size: 20px; color: var(--color-accent); margin-bottom: 15px; font-family: var(--font-display);">
                        Understanding Weighted Grades & GPA Calculation
                    </h2>
                    <p style="color: var(--color-text-main); line-height: 1.8; margin-bottom: 12px;">
                        Most courses use <strong>weighted grading systems</strong> where different components contribute varying percentages to your final grade. Common distributions include:
                    </p>
                    <ul style="color: var(--color-text-main); line-height: 1.8; margin-left: 20px; margin-bottom: 12px;">
                        <li><strong>Assignments/Homework:</strong> Typically 20-30% of final grade</li>
                        <li><strong>Tests/Quizzes:</strong> Usually 20-40% of final grade</li>
                        <li><strong>Final Exam:</strong> Often 30-50% of final grade</li>
                    </ul>
                    <p style="color: var(--color-text-main); line-height: 1.8; margin-bottom: 12px;">
                        Our <strong>GPA calculator</strong> handles these weighted components automatically, giving you precise calculations for <strong>semester grade prediction</strong> and helping you plan your study strategy effectively.
                    </p>
                </section>
                
                <section style="margin-bottom: 30px;">
                    <h2 style="font-size: 20px; color: var(--color-accent); margin-bottom: 15px; font-family: var(--font-display);">
                        Letter Grades vs Percentage Grades
                    </h2>
                    <p style="color: var(--color-text-main); line-height: 1.8; margin-bottom: 12px;">
                        This <strong>grade percentage calculator</strong> seamlessly converts between <strong>letter grades (A, B, C, D, F)</strong> and numeric percentages. The standard conversion typically follows:
                    </p>
                    <ul style="color: var(--color-text-main); line-height: 1.8; margin-left: 20px; margin-bottom: 12px;">
                        <li><strong>A Grade:</strong> 85-100% (Excellent)</li>
                        <li><strong>B Grade:</strong> 65-84% (Good)</li>
                        <li><strong>C Grade:</strong> 40-64% (Satisfactory)</li>
                        <li><strong>F Grade:</strong> 0-39% (Failing)</li>
                    </ul>
                    <p style="color: var(--color-text-main); line-height: 1.8; margin-bottom: 12px;">
                        Whether your school uses letter grades, numeric grades, or percentage-based grading, our <strong>academic grade calculator</strong> adapts to your needs.
                    </p>
                </section>
                
                <section style="margin-bottom: 30px;">
                    <h2 style="font-size: 20px; color: var(--color-accent); margin-bottom: 15px; font-family: var(--font-display);">
                        Frequently Asked Questions About Grade Calculation
                    </h2>
                    
                    <div style="margin-bottom: 20px;">
                        <h3 style="font-size: 16px; color: var(--color-text-heading); margin-bottom: 8px; font-weight: 600;">
                            What grade do I need on my final to get an A?
                        </h3>
                        <p style="color: var(--color-text-main); line-height: 1.8;">
                            Use our <strong>final exam calculator</strong> to find out! Enter all your current grades and the calculator will show you the exact percentage needed on your final exam to achieve an A grade in your course. The calculation accounts for weighted grading and shows whether your goal is realistically achievable.
                        </p>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <h3 style="font-size: 16px; color: var(--color-text-heading); margin-bottom: 8px; font-weight: 600;">
                            How accurate is this grade calculator?
                        </h3>
                        <p style="color: var(--color-text-main); line-height: 1.8;">
                            This <strong>online grade calculator</strong> uses precise mathematical formulas to calculate weighted averages and predict required scores. As long as you enter accurate grade data and correct weight percentages from your syllabus, the results are 100% accurate for <strong>target grade calculation</strong>.
                        </p>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <h3 style="font-size: 16px; color: var(--color-text-heading); margin-bottom: 8px; font-weight: 600;">
                            Can I use this for multiple classes?
                        </h3>
                        <p style="color: var(--color-text-main); line-height: 1.8;">
                            Absolutely! This <strong>course grade calculator</strong> works for any class at any level - high school, college, university, or graduate school. Calculate grades for math, science, English, history, or any subject. The tool supports unlimited calculations for all your courses.
                        </p>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <h3 style="font-size: 16px; color: var(--color-text-heading); margin-bottom: 8px; font-weight: 600;">
                            Does this calculator work for different grading scales?
                        </h3>
                        <p style="color: var(--color-text-main); line-height: 1.8;">
                            Yes! Our flexible <strong>student grade calculator</strong> supports various grading scales including 10-point, 100-point, 4.0 GPA scale, and custom scales. Whether your school uses standard letter grades or a unique system, you can customize the maximum grade values to match.
                        </p>
                    </div>
                </section>
                
                <section style="margin-bottom: 30px;">
                    <h2 style="font-size: 20px; color: var(--color-accent); margin-bottom: 15px; font-family: var(--font-display);">
                        Benefits of Using a Grade Prediction Calculator
                    </h2>
                    <ul style="color: var(--color-text-main); line-height: 1.8; margin-left: 20px;">
                        <li><strong>Strategic Planning:</strong> Know exactly what scores you need before taking exams</li>
                        <li><strong>Stress Reduction:</strong> Remove guesswork and focus your study efforts effectively</li>
                        <li><strong>Goal Setting:</strong> Set realistic academic targets based on your current performance</li>
                        <li><strong>Time Management:</strong> Prioritize courses where improvement is most needed</li>
                        <li><strong>GPA Protection:</strong> Avoid surprises and maintain your cumulative GPA</li>
                        <li><strong>Instant Results:</strong> Get calculations in seconds, not hours of manual work</li>
                        <li><strong>Multiple Scenarios:</strong> Test different "what if" scenarios for your grades</li>
                    </ul>
                </section>
                
                <section style="margin-bottom: 30px;">
                    <h2 style="font-size: 20px; color: var(--color-accent); margin-bottom: 15px; font-family: var(--font-display);">
                        Perfect for College & High School Students
                    </h2>
                    <p style="color: var(--color-text-main); line-height: 1.8; margin-bottom: 12px;">
                        Whether you're a <strong>college student</strong> managing multiple courses with complex weighted grading systems, or a <strong>high school student</strong> tracking semester grades for college applications, this <strong>free grade calculator</strong> is your essential academic planning tool.
                    </p>
                    <p style="color: var(--color-text-main); line-height: 1.8; margin-bottom: 12px;">
                        Students use this calculator for <strong>final exam preparation</strong>, <strong>semester grade planning</strong>, <strong>GPA calculation</strong>, and strategic academic decision-making. With support for multiple languages (English, Kazakh, Russian) and various grading systems, it's accessible to students worldwide.
                    </p>
                </section>
                
                <footer style="margin-top: 40px; padding-top: 20px; border-top: 1px solid #233554; text-align: center;">
                    <p style="color: var(--color-text-muted); font-size: 13px; line-height: 1.6;">
                        <strong>Grade Calculator | Final Exam Calculator | GPA Calculator | Weighted Grade Calculator</strong><br>
                        Free online tool for students to calculate target grades, predict final exam scores, and plan semester grades.<br>
                        No registration required • Instant results • Works on all devices • 100% free forever
                    </p>
                </footer>
            </article>
    <script>
        // Language switching functionality
        function setLanguage(lang) {
            document.documentElement.setAttribute('data-lang', lang);
            localStorage.setItem('language', lang);
            
            // Update active button state
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            const activeBtn = document.querySelector(`.lang-btn[onclick="setLanguage('${lang}')"]`);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
            
            updateLanguage();
        }
        
        function updateLanguage() {
            const lang = document.documentElement.getAttribute('data-lang') || 'en';
            document.querySelectorAll('[data-en]').forEach(el => {
                if (el.dataset[lang] !== undefined) {
                    // For buttons with child elements, update only the text span
                    if (el.classList.contains('calculate-btn')) {
                        const btnText = el.querySelector('.btn-text');
                        if (btnText) {
                            btnText.textContent = el.dataset[lang];
                        }
                    } else {
                        el.textContent = el.dataset[lang];
                    }
                }
            });
            
            // Update placeholder text for all elements with data-placeholder attributes
            document.querySelectorAll('[data-placeholder-en]').forEach(el => {
                const langKey = lang.charAt(0).toUpperCase() + lang.slice(1);
                const placeholderAttr = `placeholder${langKey}`;
                if (el.dataset[placeholderAttr] !== undefined) {
                    el.placeholder = el.dataset[placeholderAttr];
                }
            });
        }
        
        // Localized number formatting
        function formatNumber(num, lang = 'en') {
            if (typeof num !== 'number') return num;
            
            const options = {
                minimumFractionDigits: 0,
                maximumFractionDigits: 2
            };
            
            const localeMap = {
                'en': 'en-US',
                'kk': 'kk-KZ',
                'ru': 'ru-RU'
            };
            
            const locale = localeMap[lang] || 'en-US';
            return new Intl.NumberFormat(locale, options).format(num);
        }

        function getLetterFromNumericGrade(grade) {
            const numericGrade = typeof grade === 'string' ? parseFloat(grade) : grade;
            const rounded = Math.round(numericGrade);
            const mapping = {
                5: 'A',
                4: 'B',
                3: 'C',
                2: 'F'
            };
            return mapping[rounded] || grade;
        }

        function getLetterGradeRange(grade) {
            const numericGrade = typeof grade === 'string' ? parseFloat(grade) : grade;
            const rounded = Math.round(numericGrade);
            const mapping = {
                5: 'A (85-100%)',
                4: 'B (65-84%)',
                3: 'C (40-64%)',
                2: 'F (0-39%)'
            };
            return mapping[rounded] || grade;
        }

        function getGradeLabelText(lang) {
            if (lang === 'kk') return 'Баға';
            if (lang === 'ru') return 'Оценка';
            return 'Grade';
        }
        
        // Automatic language detection
        function detectBrowserLanguage() {
            const browserLang = navigator.language || navigator.userLanguage;
            const supportedLangs = ['en', 'kk', 'ru'];
            
            // Check if browser language matches exactly
            if (supportedLangs.includes(browserLang)) {
                return browserLang;
            }
            
            // Check if browser language starts with a supported language code
            const langPrefix = browserLang.split('-')[0];
            if (supportedLangs.includes(langPrefix)) {
                return langPrefix;
            }
            
            // Default to English
            return 'en';
        }
        
        // Set initial language (with automatic detection)
        let savedLang = localStorage.getItem('language');
        if (!savedLang) {
            savedLang = detectBrowserLanguage();
        }
        setLanguage(savedLang);
        
        // Test grade validation
        function validateTestGrade(input) {
            const testItem = input.closest('.test-item');
            const maxInput = testItem.querySelector('.test-max');
            const gradeValue = parseFloat(input.value) || 0;
            const maxValue = parseFloat(maxInput.value) || 0;
            
            if (gradeValue > maxValue && maxValue > 0) {
                input.value = maxValue;
            }
        }

        // Weight management (percentages)
        function updateWeightsTotal() {
            const weightAssignments = parseFloat(document.getElementById('weightAssignments').value) || 0;
            const weightTests = parseFloat(document.getElementById('weightTests').value) || 0;
            const weightFinal = parseFloat(document.getElementById('weightFinal').value) || 0;
            const total = weightAssignments + weightTests + weightFinal;
            
            // Update status for each section
            updateWeightStatus('assignmentsWeightStatus', weightAssignments);
            updateWeightStatus('testsWeightStatus', weightTests);
            updateWeightStatus('finalWeightStatus', weightFinal);
            
            // Check if total is 100%
            const allStatusElements = [
                document.getElementById('assignmentsWeightStatus'),
                document.getElementById('testsWeightStatus'),
                document.getElementById('finalWeightStatus')
            ];
            
            if (Math.abs(total - 100) < 0.1) {
                allStatusElements.forEach(el => {
                    if (el) {
                        el.textContent = '✓';
                        el.className = 'weight-total valid';
                    }
                });
            } else {
                allStatusElements.forEach(el => {
                    if (el) {
                        el.textContent = `Total: ${total.toFixed(1)}%`;
                        el.className = 'weight-total warning';
                    }
                });
            }
        }
        
        function updateWeightStatus(elementId, value) {
            const element = document.getElementById(elementId);
            if (!element) return;
            
            if (value < 0 || value > 100) {
                element.textContent = 'Invalid';
                element.className = 'weight-total warning';
            }
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            ['weightAssignments', 'weightTests', 'weightFinal'].forEach(id => {
                const input = document.getElementById(id);
                if (input) {
                    input.addEventListener('input', updateWeightsTotal);
                }
            });
            updateWeightsTotal();
        });

        // Assignment subsection management
        let subsectionCount = 0;
        
        function getSubsectionMax(subsection) {
            if (!subsection) return 10;
            const maxInput = subsection.querySelector('.subsection-max-input');
            const max = parseFloat(maxInput?.value);
            return max > 0 ? max : 10;
        }
        
        function updateOverallAssignmentWeight() {
            const subsections = document.querySelectorAll('.assignment-subsection');
            let totalWeight = 0;
            subsections.forEach(subsection => {
                const weight = parseFloat(subsection.querySelector('.subsection-weight-input').value) || 0;
                totalWeight += weight;
            });
            document.getElementById('weightAssignments').value = totalWeight.toFixed(1);
            updateWeightsTotal(); // Update the main weights total
        }
        
        function handleSubsectionMaxChange(input) {
            const subsection = input.closest('.assignment-subsection');
            if (!subsection) return;
            const max = getSubsectionMax(subsection);
            subsection.querySelectorAll('.grade-item input[type="number"]').forEach(gradeInput => {
                gradeInput.setAttribute('max', max);
                const value = parseFloat(gradeInput.value);
                if (!isNaN(value) && value > max) {
                    gradeInput.value = max;
                }
                updateAssignmentColor(gradeInput);
            });
        }
        
        function createGradeItem(subsectionId) {
            const item = document.createElement('div');
            item.className = 'grade-item';
            item.innerHTML = `
                <input type="number" min="0" max="10" step="0.1" placeholder="0"
                       oninput="updateAssignmentColor(this)" onkeydown="handleAssignmentKeydown(event, this)">
                <button type="button" class="remove-btn" onclick="removeGradeFromSubsection(this)">×</button>
            `;
            item.dataset.subsectionId = subsectionId;
            return item;
        }
        
        function addAssignmentSubsection() {
            const container = document.getElementById('assignmentSubsections');
            const existingSubsections = container.querySelectorAll('.assignment-subsection');
            
            let newWeight = 25;
            if (existingSubsections.length > 0) {
                let currentTotal = 0;
                existingSubsections.forEach(subsection => {
                    const weight = parseFloat(subsection.querySelector('.subsection-weight-input').value) || 0;
                    currentTotal += weight;
                });
                newWeight = Math.max(10, currentTotal / existingSubsections.length);
            }
            
            subsectionCount++;
            const subsection = document.createElement('div');
            subsection.className = 'assignment-subsection';
            subsection.dataset.subsectionId = subsectionCount;
            const subsectionName = `Type ${subsectionCount}`;
            const defaultMax = 10;
            subsection.innerHTML = `
                <button type="button" class="remove-btn" onclick="removeAssignmentSubsection(this)" title="Remove assignment type">×</button>
                <div class="assignment-subsection-header">
                    <div class="assignment-subsection-title">
                        <input type="text" class="subsection-name" placeholder="Type name (e.g., Homework)" value="${subsectionName}" data-placeholder-en="Type name (e.g., Homework)" data-placeholder-kk="Түр атауы (мысалы, Үй тапсырмасы)" data-placeholder-ru="Название типа (например, Домашнее задание)">
                    </div>
                    <div class="assignment-subsection-controls">
                        <div class="assignment-subsection-weight">
                            <label data-en="Weight:" data-kk="Салмақ:" data-ru="Вес:">Weight:</label>
                            <input type="number" class="subsection-weight-input" min="0" max="100" step="0.1" value="${newWeight.toFixed(1)}" placeholder="Weight" oninput="updateOverallAssignmentWeight()">
                            <span class="percent-label">%</span>
                        </div>
                        <div class="assignment-subsection-max">
                            <label data-en="Out of:" data-kk="Максимум:" data-ru="Максимум:">Out of:</label>
                            <input type="number" class="subsection-max-input" min="1" step="0.1" value="${defaultMax.toFixed(1)}" oninput="handleSubsectionMaxChange(this)">
                        </div>
                    </div>
                </div>
                <div class="assignment-subsection-grades" data-subsection-grades="${subsectionCount}">
                    <button type="button" class="add-btn" onclick="addGradeToSubsection(${subsectionCount})" style="grid-column: span 1;">+</button>
                </div>
            `;
            container.appendChild(subsection);
            const gradesContainer = subsection.querySelector(`[data-subsection-grades="${subsectionCount}"]`);
            const addBtn = gradesContainer.querySelector('.add-btn');
            gradesContainer.insertBefore(createGradeItem(subsectionCount), addBtn);
            handleSubsectionMaxChange(subsection.querySelector('.subsection-max-input'));
            updateOverallAssignmentWeight();
        }
        
        function removeAssignmentSubsection(btn) {
            const container = document.getElementById('assignmentSubsections');
            const subsections = container.querySelectorAll('.assignment-subsection');
            
            if (subsections.length > 1) {
                btn.closest('.assignment-subsection').remove();
                updateOverallAssignmentWeight();
            }
        }
        
        function addGradeToSubsection(subsectionId) {
            const subsection = document.querySelector(`.assignment-subsection[data-subsection-id="${subsectionId}"]`);
            if (!subsection) return;
            
            const gradesContainer = subsection.querySelector(`[data-subsection-grades="${subsectionId}"]`);
            const addBtn = gradesContainer.querySelector('.add-btn');
            const item = createGradeItem(subsectionId);
            gradesContainer.insertBefore(item, addBtn);
            handleSubsectionMaxChange(subsection.querySelector('.subsection-max-input'));
            
            // Focus on the newly created input
            const newInput = item.querySelector('input[type="number"]');
            if (newInput) {
                setTimeout(() => newInput.focus(), 0);
            }
        }
        
        function removeGradeFromSubsection(btn) {
            const gradesContainer = btn.closest('.assignment-subsection-grades');
            const gradeItems = gradesContainer.querySelectorAll('.grade-item');
            if (gradeItems.length > 1) {
                btn.parentElement.remove();
            }
        }
        
        function handleAssignmentKeydown(event, input) {
            if (event.key === 'Enter') {
                event.preventDefault();
                const subsection = input.closest('.assignment-subsection');
                if (subsection) {
                    const subsectionId = parseInt(subsection.dataset.subsectionId);
                    addGradeToSubsection(subsectionId);
                }
            }
        }
        
        function getAssignmentSubsections() {
            const subsections = [];
            document.querySelectorAll('.assignment-subsection').forEach(subsection => {
                const name = subsection.querySelector('.subsection-name').value.trim() || 'Default';
                const weight = parseFloat(subsection.querySelector('.subsection-weight-input').value) || 100;
                const max = getSubsectionMax(subsection);
                const grades = Array.from(subsection.querySelectorAll('.grade-item input[type="number"]'))
                    .map(input => {
                        const value = parseFloat(input.value);
                        return isNaN(value) ? null : value;
                    })
                    .filter(grade => grade !== null && grade >= 0);
                subsections.push({ name, weight, max, grades });
            });
            return subsections;
        }
        
        function updateAssignmentColor(input) {
            const value = parseFloat(input.value);
            const item = input.parentElement;
            const subsection = input.closest('.assignment-subsection');
            const max = getSubsectionMax(subsection);
            const normalized = (!isNaN(value) && max > 0) ? (value / max) * 10 : value;
            
            item.classList.remove('green', 'orange', 'red');
            
            if (normalized > 8) {
                item.classList.add('green');
            } else if (normalized > 5) {
                item.classList.add('orange');
            } else if (normalized > 0) {
                item.classList.add('red');
            }
        }

        // Test management
        let testCount = 0;
        
        function syncTotalTestsInput(force = false) {
            const totalTestsInput = document.getElementById('totalTests');
            if (!totalTestsInput) return;
            const currentValue = parseInt(totalTestsInput.value, 10);
            if (force || isNaN(currentValue) || currentValue < testCount) {
                totalTestsInput.value = testCount;
            }
        }
        
        function addTest() {
            const container = document.getElementById('testsContainer');
            const item = document.createElement('div');
            item.className = 'test-item';
            const lang = document.documentElement.getAttribute('data-lang') || 'en';
            const gradePlaceholder = lang === 'en' ? 'Your grade' : lang === 'kk' ? 'Сіздің баға' : 'Ваша оценка';
            const maxPlaceholder = lang === 'en' ? 'Max grade' : lang === 'kk' ? 'Максималды баға' : 'Максимальная оценка';
            
            item.innerHTML = `
                <input type="number" class="test-grade" placeholder="${gradePlaceholder}" step="0.01" min="0" oninput="validateTestGrade(this)" data-placeholder-en="Your grade" data-placeholder-kk="Сіздің баға" data-placeholder-ru="Ваша оценка">
                <span class="slash">/</span>
                <input type="number" class="test-max" placeholder="${maxPlaceholder}" step="0.01" min="1" value="10" required data-placeholder-en="Max grade" data-placeholder-kk="Максималды баға" data-placeholder-ru="Максимальная оценка">
                <button type="button" class="remove-btn" onclick="removeTest(this)">×</button>
            `;
            container.appendChild(item);
            testCount++;
            updateTestCount();
            syncTotalTestsInput(true);
            
            // Focus on the newly created grade input
            const gradeInput = item.querySelector('.test-grade');
            if (gradeInput) {
                setTimeout(() => gradeInput.focus(), 0);
            }
        }
        
        function removeTest(btn) {
            btn.parentElement.remove();
            testCount--;
            if (testCount < 0) {
                testCount = 0;
            }
            updateTestCount();
            syncTotalTestsInput();
        }
        
        function updateTestCount() {
            const countElement = document.getElementById('testCount');
            const currentLang = document.documentElement.getAttribute('data-lang') || 'en';
            const translations = {
                en: `${testCount} completed`,
                kk: `${testCount} аяқталды`,
                ru: `${testCount} завершено`
            };
            countElement.textContent = translations[currentLang] || translations.en;
        }

        // Form submission
        document.addEventListener('DOMContentLoaded', function() {
            // Ensure at least one assignment subsection exists when the page loads
            if (!document.querySelector('.assignment-subsection')) {
                addAssignmentSubsection();
            }

            // Ensure there is a visible test row and the count indicator is accurate
            if (testCount === 0) {
                addTest();
            }
            updateTestCount();

            const gradeForm = document.getElementById('gradeForm');
            if (!gradeForm) return;
            
            gradeForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const form = e.target;
                const submitBtn = form.querySelector('button[type="submit"]');
                
                if (!submitBtn) {
                    console.error('Submit button not found');
                    return;
                }
                
                const btnText = submitBtn.querySelector('.btn-text');
                const spinner = submitBtn.querySelector('.spinner');
                
                if (!btnText || !spinner) {
                    console.error('Button text or spinner not found');
                    return;
                }
                
                // Show loading state
                btnText.textContent = 'Calculating...';
                spinner.style.display = 'inline-block';
                submitBtn.disabled = true;
        
                try {
                    // Get test grades
                    const testGrades = Array.from(document.querySelectorAll('#testsContainer .test-item'))
                        .map(item => {
                            const grade = parseFloat(item.querySelector('.test-grade').value);
                            const max = parseFloat(item.querySelector('.test-max').value);
                            return { grade, max };
                        })
                        .filter(test => !isNaN(test.grade) && test.grade > 0 && !isNaN(test.max) && test.max > 0);
                    
                    // Get final exam grade (only if provided)
                    const finalGradeValue = document.getElementById('finalGrade').value.trim();
                    const finalGrade = finalGradeValue ? parseFloat(finalGradeValue) : '';
                    const finalMax = document.getElementById('finalMax').value.trim() ? parseFloat(document.getElementById('finalMax').value) : '';
                    const totalTests = parseInt(document.getElementById('totalTests').value) || testGrades.length;
                    
                    // Get weights (stay in percentages for backend)
                    const weightAssignmentsPercent = parseFloat(document.getElementById('weightAssignments').value) || 25;
                    const weightTestsPercent = parseFloat(document.getElementById('weightTests').value) || 25;
                    const weightFinalPercent = parseFloat(document.getElementById('weightFinal').value) || 50;
                    
                    // Get assignment subsections
                    const assignmentSubsections = getAssignmentSubsections();
                    
                    // Build assignment data structure for backend
                    const assignmentGrades = [];
                    const assignmentTypes = [];
                    const assignmentTypeWeights = {};
                    const assignmentTypeMaxes = {};
                    
                    if (assignmentSubsections.length > 0) {
                        assignmentSubsections.forEach(subsection => {
                            subsection.grades.forEach(grade => {
                                assignmentGrades.push(grade);
                                assignmentTypes.push(subsection.name);
                            });
                            assignmentTypeWeights[subsection.name] = subsection.weight;
                            assignmentTypeMaxes[subsection.name] = subsection.max;
                        });
                    }
                    
                    // Get current language
                    const currentLang = document.documentElement.getAttribute('data-lang') || 'en';
                    
                    // Prepare form data
                    const formData = new FormData();
                    formData.append('grades', assignmentGrades.length > 0 ? assignmentGrades.join(',') : '');
                    formData.append('assignment_types', assignmentTypes.length > 0 ? assignmentTypes.join(',') : '');
                    formData.append('assignment_type_weights', JSON.stringify(assignmentTypeWeights));
                    formData.append('assignment_type_maxes', JSON.stringify(assignmentTypeMaxes));
                    formData.append('test_grades', testGrades.map(t => t.grade).join(','));
                    formData.append('test_maxes', testGrades.map(t => t.max).join(','));
                    formData.append('final_grade', finalGrade);
                    formData.append('final_max', finalMax);
                    formData.append('total_tests', totalTests);
                    formData.append('weight_assignments', weightAssignmentsPercent);
                    formData.append('weight_tests', weightTestsPercent);
                    formData.append('weight_final', weightFinalPercent);
                    formData.append('language', currentLang);
                    
                    // Get CSRF token from the form
                    const csrftoken = document.querySelector('[name=csrfmiddlewaretoken]').value;
                    
                    // Submit the form
                    const response = await fetch('{% url "calculate_prediction" %}', {
                        method: 'POST',
                        headers: {
                            'X-CSRFToken': csrftoken,
                            'X-Requested-With': 'XMLHttpRequest'
                        },
                        body: formData
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const result = await response.json();
                    
                    // Display results
                    const resultDiv = document.getElementById('result');
                    const resultMessage = document.getElementById('resultMessage');
                    const resultDetails = document.getElementById('resultDetails');
                    
                    if (result.error) {
                        resultMessage.textContent = 'Error';
                        resultDetails.textContent = result.error;
                    } else {
                        resultMessage.textContent = result.message || 'Calculation Complete';
                        
                        const lang = document.documentElement.getAttribute('data-lang') || 'en';
                        const gradeLabelText = getGradeLabelText(lang);
                        const useLetterGrades = lang === 'en';
                        let detailsHTML = '<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">';
                        
                        if (result.current_grade !== undefined) {
                            const currentGradeDisplay = useLetterGrades ? getLetterFromNumericGrade(result.current_grade) : result.current_grade;
                            const gradeRange = useLetterGrades ? getLetterGradeRange(result.current_grade) : '';
                            detailsHTML += `<div style="text-align: center; padding: 15px; background: #0d1f3a; border-radius: 8px; border: 1px solid #233554;">
                                <div style="font-size: 12px; color: var(--color-text-muted); margin-bottom: 5px;">${gradeLabelText}</div>
                                <div style="font-size: 28px; font-weight: bold; color: var(--color-accent);">${currentGradeDisplay}</div>
                                ${gradeRange ? `<div style="font-size: 11px; color: var(--color-text-muted); margin-top: 4px;">${gradeRange}</div>` : ''}
                            </div>`;
                        }
                        if (result.current_percent !== undefined) {
                            const formattedPercent = formatNumber(result.current_percent, lang);
                            detailsHTML += `<div style="text-align: center; padding: 15px; background: #0d1f3a; border-radius: 8px; border: 1px solid #233554;">
                                <div style="font-size: 12px; color: var(--color-text-muted); margin-bottom: 5px;">Current %</div>
                                <div style="font-size: 28px; font-weight: bold; color: var(--color-accent);">${formattedPercent}%</div>
                            </div>`;
                        }
                        detailsHTML += '</div>';
                        
                        // Show predictions for each grade
                        if (result.predictions && result.predictions.length > 0) {
                            detailsHTML += '<div style="border-top: 1px solid #233554; padding-top: 15px;">';
                            detailsHTML += '<h3 style="font-size: 14px; color: var(--color-accent); margin-bottom: 12px; font-family: var(--font-code); text-transform: uppercase;">To reach each grade:</h3>';
                            
                            result.predictions.forEach(pred => {
                                const gradeColor = pred.target_grade === 5 ? '#4CAF50' : pred.target_grade === 4 ? '#FF8000' : '#8892B0';
                                const borderColor = pred.reachable ? '#4CAF50' : '#ff9800';
                                const bgColor = pred.reachable ? 'rgba(76, 175, 80, 0.1)' : 'rgba(255, 152, 0, 0.1)';
                                const gradeValueDisplay = useLetterGrades ? getLetterFromNumericGrade(pred.target_grade) : pred.target_grade;
                                
                                detailsHTML += `<div style="padding: 12px; background: ${bgColor}; border-left: 4px solid ${borderColor}; border-radius: 4px; margin-bottom: 10px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <div>
                                            <div style="font-size: 14px; font-weight: bold; color: ${gradeColor};">${gradeLabelText} ${gradeValueDisplay}</div>`;
                                
                                // If final exam percentage is specifically calculated
                                if (pred.needed_final_percent !== undefined) {
                                    const formattedFinalPercent = formatNumber(pred.needed_final_percent, lang);
                                    const formattedFinalScore = formatNumber(pred.needed_final_score, lang);
                                    detailsHTML += `<div style="font-size: 13px; color: var(--color-text-muted); margin-top: 4px;">
                                        <strong>Final Exam:</strong> ${formattedFinalPercent}% (${formattedFinalScore}/10)
                                    </div>`;
                                } else if (pred.needed_percent !== undefined) {
                                    const formattedPercent = formatNumber(pred.needed_percent, lang);
                                    detailsHTML += `<div style="font-size: 13px; color: var(--color-text-muted); margin-top: 4px;">Need: <strong>${formattedPercent}%</strong> on ${pred.missing_parts.join(' + ')}</div>`;
                                } else if (pred.needed_tens !== undefined) {
                                    if (pred.message === 'Already reached') {
                                        detailsHTML += `<div style="font-size: 13px; color: #4CAF50; margin-top: 4px;"><strong>✓ Already reached!</strong></div>`;
                                    } else {
                                        detailsHTML += `<div style="font-size: 13px; color: var(--color-text-muted); margin-top: 4px;">Need: <strong>${pred.needed_tens > 10 ? '10+' : pred.needed_tens} perfect assignment(s)</strong></div>`;
                                    }
                                }
                                
                                detailsHTML += `</div>
                                    <div style="text-align: right;">
                                        <span style="font-size: 12px; color: ${pred.reachable ? '#4CAF50' : '#ff9800'}; font-weight: bold;">
                                            ${pred.reachable ? '✓ Reachable' : '✗ Not reachable'}
                                        </span>
                                    </div>
                                </div>
                            </div>`;
                            });
                            
                            detailsHTML += '</div>';
                        }
                        
                        detailsHTML += '</div>';
                        resultDetails.innerHTML = detailsHTML || result.details || '';
                    }
                    
                    resultDiv.style.display = 'block';
                    
                } catch (error) {
                    console.error('Error:', error);
                    alert('An error occurred. Please try again.');
                } finally {
                    // Reset button state
                    const currentLang = document.documentElement.getAttribute('data-lang') || 'en';
                    btnText.textContent = currentLang === 'en' ? 'Calculate Prediction' : 
                                        currentLang === 'kk' ? 'Бағаны есептеу' : 'Рассчитать прогноз';
                    spinner.style.display = 'none';
                    submitBtn.disabled = false;
                }
            });
        });
    </script>
        </div>
    </div>
</body>
</html>